import{l as r,q as p,s as M,d as z,Z as y,a9 as G,b as l,E as u,Q as e,I as U,J as R,u as C,w as A,G as I,A as V,a4 as S,e as q,f as O}from"./vue.fad201d8.js";import{s as Y,v as $,I as D,B as h,T,cb as j,_ as L,Y as P,cc as J,g as Q,al as X,cd as Z}from"./index.044b2d75.js";import{B as N}from"./event.68ff4fe6.js";import{C as i,R as _}from"./index.3f73bd0d.js";import{F as m,a as K}from"./index.9c151d9f.js";import{i as W}from"./del.93e43054.js";import{G as ee,C as x}from"./index.8f1b0feb.js";import"./index.b6e8563b.js";import{S as ae,O as le}from"./index.cf4871b3.js";import"./index.e6a4f808.js";import"./help-circle.ad52b976.js";import"./resize-event.d6a86905.js";var ue={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","xml:space":"preserve"},te=M("path",{class:"new_svg__st0",d:"M23 7h-2V3h-4V1h4c.9 0 2 1.1 2 2v4zm0 3v4h-2v-4h2zM1 10h2v4H1v-4zm0-3V3c0-.9 1.1-2 2-2h4v2H3v4H1zm16 16v-2h4v-4h2v4c0 .9-1 2-2 2h-4zm-3 0h-4v-2h4v2zm0-22v2h-4V1h4zM1 17h2v4h4v2H3c-.9 0-2-1.1-2-2v-4zM17 11h-4V7c0-.5-.5-1-1-1s-1 .5-1 1v4H7c-.5 0-1 .5-1 1s.6 1 1 1h4v4c0 .5.5 1 1 1s1-.5 1-1v-4h4c.5 0 1-.5 1-1s-.5-1-1-1z"},null,-1),se=[te];function oe(B,g){return r(),p("svg",ue,[].concat(se))}var ne={render:oe},H=function(){return Y({name:"IconNew",component:ne})()};const re={key:0},de={key:0},ie={key:1},ve={key:2},pe={key:3},me=z({__name:"password-acl",props:{aclList:Array},emits:["onChange"],setup(B,{emit:g}){const n=H(),d=W();$.useI18n();const a=y({alg:"plain",salt:"",saltType:"disable",password:"",username:""}),f=B,w=g,{aclList:c}=G(f),s=y((c==null?void 0:c.value)||[]),F=b=>{s.value=s.value.filter(o=>o.username!==b).map(o=>o),w("onChange",s.value)},v=async()=>{var t,E;if(!((t=a.value.username)!=null&&t.trim())){T.message({message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",status:"error"});return}if(!((E=a.value.password)!=null&&E.trim())){T.message({message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",status:"error"});return}if(s.value.filter(k=>k.username===a.value.username).length>0){T.message({message:"\u7528\u6237\u540D: ".concat(a.value.username," \u5DF2\u5B58\u5728"),status:"error"});return}let o=a.value.password;if(a.value.alg==="md5"||a.value.alg==="sha256"){a.value.saltType==="prefix"&&a.value.salt?o=a.value.salt+a.value.password:a.value.saltType==="suffix"&&a.value.salt&&(o=a.value.password+a.value.salt);const{data:k}=await j({password:o,alg:a.value.alg});o=k}s.value.push({username:a.value.username,password:o,salt:a.value.salt,saltType:a.value.saltType,alg:a.value.alg}),w("onChange",s.value),a.value.salt="",a.value.username="",a.value.password=""};return(b,o)=>(r(),p(U,null,[l(e(_),null,{default:u(()=>[l(e(i),{span:4},{default:u(()=>[l(e(m),{label:"\u7528\u6237\u540D"},{default:u(()=>[l(e(D),{modelValue:a.value.username,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value.username=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(e(_),null,{default:u(()=>[l(e(i),{span:4},{default:u(()=>[l(e(m),{label:"\u5BC6\u7801"},{default:u(()=>[l(e(D),{modelValue:a.value.password,"onUpdate:modelValue":o[1]||(o[1]=t=>a.value.password=t),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),l(e(i),{span:2},{default:u(()=>[l(e(m),{label:"\u5B58\u50A8\u52A0\u5BC6"},{default:u(()=>[l(e(ae),{modelValue:a.value.alg,"onUpdate:modelValue":o[2]||(o[2]=t=>a.value.alg=t),"input-box-type":"underline",placeholder:"\u5BC6\u7801\u52A0\u5BC6\u65B9\u5F0F"},{default:u(()=>[(r(),p(U,null,R([{value:"plain",label:"\u660E\u6587"},{value:"md5",label:"md5"},{value:"sha256",label:"sha256"}],t=>l(e(le),{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(e(_),null,{default:u(()=>[a.value.alg&&a.value.alg!="plain"?(r(),p("div",re,[l(e(m),{label:"\u52A0\u76D0"},{default:u(()=>[l(e(i),{span:3},{default:u(()=>[l(e(N),{modelValue:a.value.saltType,"onUpdate:modelValue":o[3]||(o[3]=t=>a.value.saltType=t),size:"mini",data:[{text:"\u4E0D\u52A0\u76D0",value:"disable"},{text:"\u5934\u90E8\u52A0\u76D0",value:"prefix"},{text:"\u5C3E\u90E8\u52A0\u76D0",value:"suffix"}]},null,8,["modelValue"])]),_:1}),a.value.saltType!="disable"?(r(),C(e(i),{key:0,span:2},{default:u(()=>[l(e(D),{modelValue:a.value.salt,"onUpdate:modelValue":o[4]||(o[4]=t=>a.value.salt=t),placeholder:"\u8BF7\u8F93\u5165\u76D0\u503C"},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})])):A("",!0)]),_:1}),l(e(_),null,{default:u(()=>[l(e(i),{span:1}),l(e(i),{span:3},{default:u(()=>[l(e(h),{icon:e(n),"reset-time":200,type:"info",onClick:v},{default:u(()=>[I("\u6DFB\u52A0\u4E00\u6761\u8BA4\u8BC1\u4FE1\u606F")]),_:1},8,["icon"])]),_:1})]),_:1}),l(e(_),null,{default:u(()=>[l(e(i),null,{default:u(()=>[l(e(m),{label:"\u8BA4\u8BC1\u4FE1\u606F"},{default:u(()=>[l(e(ee),{data:s.value,optimization:{animat:!0,delayHover:250,scrollX:{gt:20},scrollY:{gt:30}}},{default:u(()=>[l(e(x),{type:"index",width:"60"}),l(e(x),{field:"username",title:"\u7528\u6237\u540D"}),l(e(x),{field:"password",title:"\u5B58\u50A8\u5BC6\u6587"},{default:u(t=>[I(V(t.row.alg)+": "+V(t.row.password),1)]),_:1}),l(e(x),{field:"desc",title:"\u52A0\u76D0"},{default:u(t=>[t.row.saltType=="prefix"?(r(),p("div",de,"\u524D\u7F6E\u52A0\u76D0\uFF1A"+V(t.row.salt),1)):t.row.saltType=="suffix"?(r(),p("div",ie,"\u5C3E\u90E8\u52A0\u76D0\uFF1A"+V(t.row.salt),1)):t.row.saltType=="disable"?(r(),p("div",ve,"\u4E0D\u52A0\u76D0")):(r(),p("div",pe,"\u65E0\u6548\u52A0\u76D0\u7C7B\u578B:"+V(t.row.saltType),1))]),_:1}),l(e(x),{title:"\u64CD\u4F5C"},{default:u(t=>[l(e(h),{icon:e(d),"reset-time":200,type:"text",size:"mini",onClick:E=>F(t.row.username)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})],64))}}),fe=z({__name:"restful-acl",props:{modelValue:{type:Object,default:()=>({})}},setup(B){$.useI18n();const n=y(B.modelValue);return(d,a)=>(r(),C(e(_),null,{default:u(()=>[l(e(i),{span:6},{default:u(()=>[l(e(m),{label:"RestAPI\u5730\u5740",required:""},{default:u(()=>[l(e(D),{modelValue:n.value.url,"onUpdate:modelValue":a[0]||(a[0]=f=>n.value.url=f)},null,8,["modelValue"])]),_:1}),l(e(m),{label:"Headers",required:""},{default:u(()=>[l(e(D),{modelValue:n.value.headers,"onUpdate:modelValue":a[1]||(a[1]=f=>n.value.headers=f),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});const ce={class:"container"},_e=z({__name:"index",setup(B){H();const g=P();S({loading:null}),$.useI18n(),y(!1);const n=y({}),d=y("none"),a=y({}),f=async c=>{const{data:s}=await J();n.value=s||{type:"default"},a.value=n.value.restapi||{},c&&c()},w=async()=>{console.log("restapi",a),n.value.version=new Date().getTime(),n.value.restapi=a,await Z(n.value),f()};return q(()=>{f(function(){d.value=n.value.type})}),(c,s)=>{const F=O("Breadcrumb");return r(),p("div",ce,[l(F,{items:["menu.system","menu.system.users"]},null,8,["items"]),l(e(X),{class:"content"},{default:u(()=>[l(e(K),{disabled:!1,"label-position":"right","label-width":"100px"},{default:u(()=>[l(e(_),null,{default:u(()=>[l(e(i),{span:5},{default:u(()=>[l(e(m),{label:"\u8BA4\u8BC1\u65B9\u5F0F",required:""},{default:u(()=>[l(e(N),{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=v=>d.value=v),data:[{text:"\u65E0\u9700\u8BA4\u8BC1",value:"none"},{text:"\u5BC6\u7801\u8BA4\u8BC1",value:"default"},{text:"RestAPI",value:"restapi"}]},null,8,["modelValue"])]),_:1})]),_:1}),l(e(i),{span:1},{default:u(()=>[l(e(Q),{effect:"dark",content:"\u5207\u6362\u8BA4\u8BC1\u65B9\u5F0F",placement:"right-start"},{default:u(()=>[l(e(h),{type:"success",icon:e(g),size:"mini",circle:"",onClick:s[1]||(s[1]=v=>{n.value.type=d.value,w()})},null,8,["icon"])]),_:1})]),_:1})]),_:1}),d.value=="default"?(r(),C(me,{key:0,"acl-list":n.value.default,onOnChange:s[2]||(s[2]=v=>{n.value.default=v,w()})},null,8,["acl-list"])):A("",!0),d.value=="restapi"?(r(),C(fe,{key:1,modelValue:a.value,"onUpdate:modelValue":s[3]||(s[3]=v=>a.value=v)},null,8,["modelValue"])):A("",!0),d.value!="default"&&d.value!="none"?(r(),C(e(m),{key:2},{default:u(()=>[l(e(h),{type:"primary",onClick:s[4]||(s[4]=v=>w())},{default:u(()=>[I("\u4FDD\u5B58")]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})])}}});var Ee=L(_e,[["__scopeId","data-v-6ccb61d0"]]);export{Ee as default};
