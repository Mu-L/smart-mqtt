import{u as r,w as f,x as H,d as z,g,aj as M,e as a,G as u,Y as e,N as $,O as R,y as C,z as A,J as T,E as x,ac as G,l as O,q as S}from"./vue.bcdebe48.js";import{s as q,Q as Y,u as I,I as D,B as h,T as k,d6 as j,_ as L,R as P,d7 as J,i as K,a7 as Q,d8 as X}from"./index.47a844b4.js";import{O as W,K as U,G as Z,C as V}from"./index.f36fe667.js";import{C as m,R as B}from"./index.3cc3aa39.js";import{F as c,a as ee}from"./index.a4b20517.js";import"./index.501e01da.js";import{S as ae}from"./index.ae3308be.js";import"./ellipsis.88b53929.js";var le={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","xml:space":"preserve"},ue=H("path",{class:"new_svg__st0",d:"M23 7h-2V3h-4V1h4c.9 0 2 1.1 2 2v4zm0 3v4h-2v-4h2zM1 10h2v4H1v-4zm0-3V3c0-.9 1.1-2 2-2h4v2H3v4H1zm16 16v-2h4v-4h2v4c0 .9-1 2-2 2h-4zm-3 0h-4v-2h4v2zm0-22v2h-4V1h4zM1 17h2v4h4v2H3c-.9 0-2-1.1-2-2v-4zM17 11h-4V7c0-.5-.5-1-1-1s-1 .5-1 1v4H7c-.5 0-1 .5-1 1s.6 1 1 1h4v4c0 .5.5 1 1 1s1-.5 1-1v-4h4c.5 0 1-.5 1-1s-.5-1-1-1z"},null,-1),te=[ue];function se(w,_){return r(),f("svg",le,[].concat(te))}var ne={render:se},N=function(){return q({name:"IconNew",component:ne})()};const oe={key:0},re={key:0},de={key:1},ie={key:2},ve={key:3},pe=z({__name:"password-acl",props:{aclList:Array},emits:["onChange"],setup(w,{emit:_}){const n=w,i=N(),d=Y();I();const l=g({alg:"plain",salt:"",saltType:"disable",password:"",username:""}),{aclList:y}=M(n),v=g((y==null?void 0:y.value)||[]),o=p=>{v.value=v.value.filter(s=>s.username!==p).map(s=>s),_("onChange",v.value)},F=async()=>{var t,b;if(!((t=l.value.username)!=null&&t.trim())){k.message({message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",status:"error"});return}if(!((b=l.value.password)!=null&&b.trim())){k.message({message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",status:"error"});return}if(v.value.filter(E=>E.username===l.value.username).length>0){k.message({message:"\u7528\u6237\u540D: ".concat(l.value.username," \u5DF2\u5B58\u5728"),status:"error"});return}let s=l.value.password;if(l.value.alg==="md5"||l.value.alg==="sha256"){l.value.saltType==="prefix"&&l.value.salt?s=l.value.salt+l.value.password:l.value.saltType==="suffix"&&l.value.salt&&(s=l.value.password+l.value.salt);const{data:E}=await j({password:s,alg:l.value.alg});s=E}v.value.push({username:l.value.username,password:s,salt:l.value.salt,saltType:l.value.saltType,alg:l.value.alg}),_("onChange",v.value),l.value.salt="",l.value.username="",l.value.password=""};return(p,s)=>(r(),f($,null,[a(e(B),null,{default:u(()=>[a(e(m),{span:4},{default:u(()=>[a(e(c),{label:"\u7528\u6237\u540D"},{default:u(()=>[a(e(D),{modelValue:l.value.username,"onUpdate:modelValue":s[0]||(s[0]=t=>l.value.username=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(e(B),null,{default:u(()=>[a(e(m),{span:4},{default:u(()=>[a(e(c),{label:"\u5BC6\u7801"},{default:u(()=>[a(e(D),{modelValue:l.value.password,"onUpdate:modelValue":s[1]||(s[1]=t=>l.value.password=t),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),a(e(m),{span:2},{default:u(()=>[a(e(c),{label:"\u5B58\u50A8\u52A0\u5BC6"},{default:u(()=>[a(e(ae),{modelValue:l.value.alg,"onUpdate:modelValue":s[2]||(s[2]=t=>l.value.alg=t),"input-box-type":"underline",placeholder:"\u5BC6\u7801\u52A0\u5BC6\u65B9\u5F0F"},{default:u(()=>[(r(),f($,null,R([{value:"plain",label:"\u660E\u6587"},{value:"md5",label:"md5"},{value:"sha256",label:"sha256"}],t=>a(e(W),{key:t.value,label:t.label,value:t.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(e(B),null,{default:u(()=>[l.value.alg&&l.value.alg!="plain"?(r(),f("div",oe,[a(e(c),{label:"\u52A0\u76D0"},{default:u(()=>[a(e(m),{span:3},{default:u(()=>[a(e(U),{modelValue:l.value.saltType,"onUpdate:modelValue":s[3]||(s[3]=t=>l.value.saltType=t),size:"mini",data:[{text:"\u4E0D\u52A0\u76D0",value:"disable"},{text:"\u5934\u90E8\u52A0\u76D0",value:"prefix"},{text:"\u5C3E\u90E8\u52A0\u76D0",value:"suffix"}]},null,8,["modelValue"])]),_:1}),l.value.saltType!="disable"?(r(),C(e(m),{key:0,span:2},{default:u(()=>[a(e(D),{modelValue:l.value.salt,"onUpdate:modelValue":s[4]||(s[4]=t=>l.value.salt=t),placeholder:"\u8BF7\u8F93\u5165\u76D0\u503C"},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})])):A("",!0)]),_:1}),a(e(B),null,{default:u(()=>[a(e(m),{span:1}),a(e(m),{span:3},{default:u(()=>[a(e(h),{icon:e(i),"reset-time":200,type:"info",onClick:F},{default:u(()=>[T("\u6DFB\u52A0\u4E00\u6761\u8BA4\u8BC1\u4FE1\u606F")]),_:1},8,["icon"])]),_:1})]),_:1}),a(e(B),null,{default:u(()=>[a(e(m),null,{default:u(()=>[a(e(c),{label:"\u8BA4\u8BC1\u4FE1\u606F"},{default:u(()=>[a(e(Z),{data:v.value,optimization:{animat:!0,delayHover:250,scrollX:{gt:20},scrollY:{gt:30}}},{default:u(()=>[a(e(V),{type:"index",width:"60"}),a(e(V),{field:"username",title:"\u7528\u6237\u540D"}),a(e(V),{field:"password",title:"\u5B58\u50A8\u5BC6\u6587"},{default:u(t=>[T(x(t.row.alg)+": "+x(t.row.password),1)]),_:1}),a(e(V),{field:"desc",title:"\u52A0\u76D0"},{default:u(t=>[t.row.saltType=="prefix"?(r(),f("div",re,"\u524D\u7F6E\u52A0\u76D0\uFF1A"+x(t.row.salt),1)):t.row.saltType=="suffix"?(r(),f("div",de,"\u5C3E\u90E8\u52A0\u76D0\uFF1A"+x(t.row.salt),1)):t.row.saltType=="disable"?(r(),f("div",ie,"\u4E0D\u52A0\u76D0")):(r(),f("div",ve,"\u65E0\u6548\u52A0\u76D0\u7C7B\u578B:"+x(t.row.saltType),1))]),_:1}),a(e(V),{title:"\u64CD\u4F5C"},{default:u(t=>[a(e(h),{icon:e(d),"reset-time":200,type:"text",size:"mini",onClick:b=>o(t.row.username)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})],64))}}),me=z({__name:"restful-acl",props:{modelValue:{type:Object,default:()=>({})}},setup(w){const _=w;I();const n=g(_.modelValue);return(i,d)=>(r(),C(e(B),null,{default:u(()=>[a(e(m),{span:6},{default:u(()=>[a(e(c),{label:"RestAPI\u5730\u5740",required:""},{default:u(()=>[a(e(D),{modelValue:n.value.url,"onUpdate:modelValue":d[0]||(d[0]=l=>n.value.url=l)},null,8,["modelValue"])]),_:1}),a(e(c),{label:"Headers",required:""},{default:u(()=>[a(e(D),{modelValue:n.value.headers,"onUpdate:modelValue":d[1]||(d[1]=l=>n.value.headers=l),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});const fe={class:"container"},ce=z({__name:"index",setup(w){N();const _=P();G({loading:null}),I(),g(!1);const n=g({}),i=g("none"),d=g({}),l=async v=>{const{data:o}=await J();n.value=o||{type:"default"},d.value=n.value.restapi||{},v&&v()},y=async()=>{console.log("restapi",d),n.value.version=new Date().getTime(),n.value.restapi=d,await X(n.value),l()};return O(()=>{l(function(){i.value=n.value.type})}),(v,o)=>{const F=S("Breadcrumb");return r(),f("div",fe,[a(F,{items:["menu.resource","menu.resource.plugins"]},null,8,["items"]),a(e(Q),{class:"content"},{default:u(()=>[a(e(ee),{disabled:!1,"label-position":"right","label-width":"100px"},{default:u(()=>[a(e(B),null,{default:u(()=>[a(e(m),{span:5},{default:u(()=>[a(e(c),{label:"\u8BA4\u8BC1\u65B9\u5F0F",required:""},{default:u(()=>[a(e(U),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=p=>i.value=p),data:[{text:"\u65E0\u9700\u8BA4\u8BC1",value:"none"},{text:"\u5BC6\u7801\u8BA4\u8BC1",value:"default"},{text:"RestAPI",value:"restapi"}]},null,8,["modelValue"])]),_:1})]),_:1}),a(e(m),{span:1},{default:u(()=>[a(e(K),{effect:"dark",content:"\u5207\u6362\u8BA4\u8BC1\u65B9\u5F0F",placement:"right-start"},{default:u(()=>[a(e(h),{type:"success",icon:e(_),size:"mini",circle:"",onClick:o[1]||(o[1]=p=>{n.value.type=i.value,y()})},null,8,["icon"])]),_:1})]),_:1})]),_:1}),i.value=="default"?(r(),C(pe,{key:0,"acl-list":n.value.default,onOnChange:o[2]||(o[2]=p=>{n.value.default=p,y()})},null,8,["acl-list"])):A("",!0),i.value=="restapi"?(r(),C(me,{key:1,modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=p=>d.value=p)},null,8,["modelValue"])):A("",!0),i.value!="default"&&i.value!="none"?(r(),C(e(c),{key:2},{default:u(()=>[a(e(h),{type:"primary",onClick:o[4]||(o[4]=p=>y())},{default:u(()=>[T("\u4FDD\u5B58")]),_:1})]),_:1})):A("",!0)]),_:1})]),_:1})])}}});var Ae=L(ce,[["__scopeId","data-v-b47fe840"]]);export{Ae as default};
