import{u as i,w as D,x as n,d as z,g as h,l as T,a as H,y as g,G as t,Y as e,e as a,O as G,A as j,E as P,J as d,z as b,N as U,$ as R,a0 as q,a6 as J,ac as O}from"./vue.637c7bf1.js";import{s as S,dn as $,aF as W,I as Y,dp as K,B as w,dq as Q,_ as N,T as f,a_ as X,a2 as ee}from"./index.f4bbbc44.js";import{T as A,K as te,C as B,G as ae,D as se,b as ue,g as ne}from"./index.e38f6ab9.js";import{F as le}from"./index.5bbdcd79.js";import{T as M,a as ie}from"./index.61e4567b.js";import"./index.c3346299.js";import"./ellipsis.7930923b.js";import"./index.63e2a6ef.js";import"./plus.f4ad9ec4.js";var oe={viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},re=n("path",{d:"M9.1 1.6a2.38 2.38 0 0 0-2.2 0L2.03 4.24c-.21.12-.39.28-.51.49-.39.64-.16 1.46.51 1.82L6.9 9.18c.68.37 1.52.37 2.2 0l4.87-2.63c.21-.12.39-.29.51-.49.39-.64.16-1.46-.51-1.82L9.1 1.6Zm-.48.88a1.35 1.35 0 0 0-1.24 0L2.51 5.12a.31.31 0 0 0-.13.12c-.09.15-.04.34.13.43L7.38 8.3c.39.21.86.21 1.24 0l4.88-2.63c.06-.03.1-.07.13-.129.09-.14.03-.33-.13-.422L8.62 2.48Zm5.34 5.76c.25-.13.55-.03.68.22.12.24.02.54-.22.67L9 11.9c-.63.32-1.39.32-2.02-.02L1.82 9.12a.487.487 0 0 1-.21-.67c.13-.25.43-.33.67-.21L7.45 11c.34.18.75.18 1.09 0l5.42-2.76Zm.68 2.77a.5.5 0 0 0-.68-.219l-5.42 2.77c-.34.18-.75.17-1.09-.01L2.28 10.8a.493.493 0 0 0-.67.199.5.5 0 0 0 .21.68l5.16 2.75c.63.34 1.39.35 2.02.02l5.42-2.77c.24-.12.34-.42.22-.67Z","clip-rule":"evenodd","fill-rule":"evenodd"},null,-1),ce=[re];function de(l,y){return i(),D("svg",oe,[].concat(ce))}var pe={render:de},_e=function(){return S({name:"IconApp",component:pe})()},me={viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},ge=n("path",{d:"M12.22 5.18C11.68 3.28 9.99 1.92 8 1.92h-.22c-1.97.1-3.61 1.53-4.07 3.47l-.17.02C1.97 5.68.77 7.07.77 8.74c0 1.86 1.48 3.38 3.31 3.38.53 0 1.05-.13 1.51-.38.24-.13.33-.44.2-.68a.496.496 0 0 0-.67-.2c-.32.17-.68.26-1.04.26-1.27 0-2.31-1.06-2.31-2.38l.01-.16c.08-1.18.99-2.13 2.14-2.2l.13-.01h.08c.25 0 .46-.18.5-.43C4.87 4.208 6.3 2.92 8 2.92c1.69 0 3.12 1.289 3.36 3.02.04.25.25.43.5.43h.07l.14.01c1.2.079 2.14 1.11 2.14 2.36 0 1.32-1.03 2.38-2.3 2.38-.43 0-.84-.13-1.2-.36a.503.503 0 1 0-.55.84c.52.34 1.12.52 1.75.52 1.83 0 3.3-1.52 3.3-3.38v-.18c-.08-1.59-1.25-2.89-2.76-3.15l-.17-.02-.06-.21ZM8.41 7.02l1.53 1.93c.18.21.14.53-.08.7a.496.496 0 0 1-.7-.08l-.66-.84v4.77c0 .28-.23.5-.5.5-.28 0-.5-.22-.5-.5V8.75l-.68.83c-.15.18-.42.23-.63.12l-.07-.05a.508.508 0 0 1-.07-.71l1.58-1.92a.5.5 0 0 1 .78 0Z","clip-rule":"evenodd","fill-rule":"evenodd"},null,-1),ve=[ge];function fe(l,y){return i(),D("svg",me,[].concat(ve))}var he={render:fe},Fe=function(){return S({name:"IconFileupload",component:he})()},Ce={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","xml:space":"preserve"},ye=n("path",{class:"shopping-card_svg__st0",d:"M21.7 15.9h-14l.9-1h11.5c.4 0 .7-.8.8-1.1l1.6-9c0-.2 0-.5-.2-.7-.1-.2-.4-.1-.6-.1H7.1l-.3-1c-.1-.4-.5-.9-.9-.9H2.3c-.4 0-.8.4-.8.9s.4 1 .8 1H5l.7 3 1.5 6.2-1.7 3.1c-.2.3-.2.6-.1.9.1.3.4.5.7.5h1.5c-.4.3-.5.8-.5 1.3 0 1.3 1.1 2.4 2.4 2.4s2.4-1.1 2.4-2.4c0-.5-.2-1-.5-1.4h3.8c-.3.4-.5.9-.5 1.4 0 1.3 1.1 2.4 2.4 2.4 1.3 0 2.4-1.1 2.4-2.4 0-.5-.2-1-.5-1.4h2.7c.5 0 .8-.4.8-.8 0-.5-.4-.9-.8-.9zM7.5 5.9h12.8L19.1 13H9L7.5 5.9zm2 13.9c-.4 0-.7-.3-.7-.7s.3-.7.7-.7c.4 0 .7.3.7.7 0 .3-.3.7-.7.7zm7.6 0c-.4 0-.7-.3-.7-.7s.3-.7.7-.7c.4 0 .7.3.7.7 0 .3-.3.7-.7.7z"},null,-1),De=[ye];function we(l,y){return i(),D("svg",Ce,[].concat(De))}var ke={render:we},xe=function(){return S({name:"IconShoppingCard",component:ke})()};function be(){return $.get("/api/plugin/market")}function $e(l){return $.post(`/api/plugin/install?id=${l}`)}function Ee(){return $.post("/api/plugin/list")}function Be(l){return $.post(`/api/plugin/enable?id=${l}`)}function Pe(l){return $.post(`/api/plugin/disable?id=${l}`)}function Ae(l){return $.post(`/api/plugin/uninstall?id=${l}`)}const V=l=>(R("data-v-d04bbe06"),l=l(),q(),l),Le={class:"plugin-list"},Ie={class:"search-box"},Me=["onClick"],ze={class:"plugin-logo"},Te=["alt"],Se={class:"plugin-info"},Ve={class:"plugin-name"},Ue={key:0,class:"no-result"},Ne={key:0,class:"plugin-detail"},Ze={class:"plugin-header"},He={class:"plugin-title"},Ge={class:"plugin-info-detail"},je={class:"info-item"},Re=V(()=>n("label",null,"\u7248\u672C\uFF1A",-1)),qe={class:"info-item"},Je=V(()=>n("label",null,"\u72B6\u6001\uFF1A",-1)),Oe={class:"info-item"},We=V(()=>n("label",null,"\u63CF\u8FF0\uFF1A",-1)),Ye=z({__name:"MarketPlugins",setup(l,{expose:y}){const k=W(),F=h([]),u=h(null),C=async()=>{const{data:s}=await be();F.value=s},v=s=>{u.value=s},E=async s=>{try{await $e(s.id),s.status="inactive",C()}catch(c){console.error("\u5B89\u88C5\u63D2\u4EF6\u5931\u8D25:",c)}};y({fetchMarketPlugins:C}),T(()=>{C(),F.value.length>0});const o=h(""),p=H(()=>{const s=o.value.toLowerCase().trim();return s?F.value.filter(c=>c.name.toLowerCase().includes(s)||c.description.toLowerCase().includes(s)):F.value});return(s,c)=>(i(),g(e(Q),{pattern:"simple",asideWidth:"350px"},{aside:t(()=>[n("div",Le,[n("div",Ie,[a(e(Y),{"prefix-icon":e(k),modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=m=>o.value=m),placeholder:"\u641C\u7D22\u63D2\u4EF6\u540D\u79F0\u6216\u63CF\u8FF0",clearable:""},null,8,["prefix-icon","modelValue"])]),(i(!0),D(U,null,G(p.value,m=>{var L;return i(),D("div",{key:m.id,class:j(["plugin-item",{active:((L=u.value)==null?void 0:L.id)===m.id}]),onClick:I=>v(m)},[n("div",ze,[n("img",{src:K,alt:m.name},null,8,Te)]),n("div",Se,[n("div",Ve,P(m.name),1),m.status==="disabled"?(i(),g(e(A),{key:0,type:"warning",size:"mini"},{default:t(()=>[d(" \u672A\u6FC0\u6D3B ")]),_:1})):m.status==="enabled"?(i(),g(e(A),{key:1,type:"success",size:"mini"},{default:t(()=>[d(" \u5DF2\u6FC0\u6D3B ")]),_:1})):b("",!0)])],10,Me)}),128)),p.value.length===0?(i(),D("div",Ue," \u672A\u627E\u5230\u5339\u914D\u7684\u63D2\u4EF6 ")):b("",!0)])]),default:t(()=>[u.value?(i(),D("div",Ne,[n("div",Ze,[n("div",He,[a(e(_e),{size:"32"}),n("h2",null,P(u.value.name),1)]),a(e(te),null,{default:t(()=>[u.value.status==="uninstall"?(i(),g(e(w),{key:0,onClick:c[1]||(c[1]=m=>E(u.value))},{default:t(()=>[d("\u5B89\u88C5")]),_:1})):u.value.status=="disabled"?(i(),g(e(w),{key:1,type:"primary"},{default:t(()=>[d("\u6FC0\u6D3B")]),_:1})):u.value.status=="enabled"?(i(),g(e(w),{key:2,type:"danger"},{default:t(()=>[d("\u505C\u7528")]),_:1})):b("",!0)]),_:1})]),n("div",Ge,[n("div",je,[Re,n("span",null,P(u.value.version),1)]),n("div",qe,[Je,u.value.status==="disabled"?(i(),g(e(A),{key:0,type:"warning",size:"mini"},{default:t(()=>[d(" \u672A\u6FC0\u6D3B ")]),_:1})):u.value.status==="enabled"?(i(),g(e(A),{key:1,type:"success",size:"mini"},{default:t(()=>[d(" \u5DF2\u6FC0\u6D3B ")]),_:1})):b("",!0)]),n("div",Oe,[We,n("p",null,P(u.value.description),1)])])])):b("",!0)]),_:1}))}});var Ke=N(Ye,[["__scopeId","data-v-d04bbe06"]]);const Qe=z({__name:"PluginList",emits:["config"],setup(l,{expose:y}){const k=h(!1),F=h([]);async function u(){k.value=!0;try{const{data:o}=await Ee();console.log("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u6210\u529F:",o),F.value=o}catch(o){throw console.error("\u83B7\u53D6\u63D2\u4EF6\u5217\u8868\u5931\u8D25:",o),o}finally{k.value=!1}}y({fetchPluginData:u});async function C(o){const p=await Be(o);if(p.code!==200){f.message({message:p.message,status:"danger"});return}f.message({message:"\u63D2\u4EF6\u6FC0\u6D3B\u6210\u529F",status:"success"}),u()}async function v(o){const p=await Ae(o);if(p.code!==200){f.message({message:p.message,status:"danger"});return}f.message({message:"\u63D2\u4EF6\u5378\u8F7D\u6210\u529F",status:"success"}),u()}async function E(o){const p=await Pe(o);if(p.code!==200){f.message({message:p.message,status:"danger"});return}f.message({message:"\u63D2\u4EF6\u5DF2\u505C\u7528",status:"warning"}),u()}return T(()=>{u()}),(o,p)=>(i(),g(e(ae),{data:F.value},{default:t(()=>[a(e(B),{field:"name",title:"\u63D2\u4EF6\u540D\u79F0",width:"200"}),a(e(B),{field:"version",title:"\u7248\u672C",width:"80"}),a(e(B),{field:"status",title:"\u72B6\u6001",width:"120"},{default:t(s=>[a(e(A),{type:s.row.status==="enabled"?"success":"danger"},{default:t(()=>[d(P(s.row.status==="enabled"?"\u5DF2\u6FC0\u6D3B":"\u672A\u6FC0\u6D3B"),1)]),_:2},1032,["type"])]),_:1}),a(e(B),{field:"description",title:"\u63CF\u8FF0"}),a(e(B),{title:"\u64CD\u4F5C",width:"300"},{default:t(s=>[s.row.status==="disabled"?(i(),g(e(w),{key:0,type:"primary",size:"mini",onClick:c=>v(s.row.id)},{default:t(()=>[d("\u5378\u8F7D")]),_:2},1032,["onClick"])):b("",!0),s.row.status==="disabled"?(i(),g(e(w),{key:1,type:"primary",size:"mini",onClick:c=>C(s.row.id)},{default:t(()=>[d("\u6FC0\u6D3B")]),_:2},1032,["onClick"])):(i(),g(e(w),{key:2,type:"danger",size:"mini",onClick:c=>E(s.row.id)},{default:t(()=>[d("\u505C\u7528")]),_:2},1032,["onClick"])),a(e(w),{size:"mini",onClick:c=>o.$emit("config",s.row.id)},{default:t(()=>[d("\u914D\u7F6E")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]))}});const Xe={class:"plugin-container"},et=z({__name:"index",setup(l){const y=X(),k=xe(),F=Fe(),u=h("market"),C=h(),v=h();J(u,r=>{var _,x;r==="market"&&((_=C.value)==null?void 0:_.fetchMarketPlugins)?C.value.fetchMarketPlugins():r==="installed"&&((x=v.value)==null?void 0:x.fetchDataOption)&&v.value.fetchPluginData()});function E(r){return r!=="settting"}const o=h("/api/plugin/upload"),p=O({Authorization:`Bearer ${localStorage.getItem("token")}`});function s(r){const _=r.name.endsWith(".jar");return _||f.message({message:"\u53EA\u80FD\u4E0A\u4F20.jar\u683C\u5F0F\u7684\u6587\u4EF6",status:"error"}),_}function c(r){var _;if(console.log("aa",r),r.code!==200){f.message({message:r.message,status:"error"});return}f.message({message:"\u63D2\u4EF6\u4E0A\u4F20\u6210\u529F",status:"success"}),(_=v==null?void 0:v.value)==null||_.fetchPluginData()}function m(r){f.message({message:`\u4E0A\u4F20\u5931\u8D25: ${r.message}`,status:"error"})}function L(r){console.log(`\u4E0A\u4F20\u8FDB\u5EA6: ${Math.round(r.loaded/r.total*100)}%`)}const I=h(!1);function Z(){I.value=!0}return T(()=>{}),(r,_)=>(i(),D(U,null,[n("div",Xe,[a(e(ie),{modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=x=>u.value=x),"before-leave":E},{default:t(()=>[a(e(M),{name:"market"},{title:t(()=>[a(e(k)),d(" \xA0 \u63D2\u4EF6\u5E02\u573A ")]),default:t(()=>[a(Ke,{ref_key:"marketPluginsRef",ref:C},null,512)]),_:1}),a(e(M),{title:"\u5DF2\u5B89\u88C5\u63D2\u4EF6",name:"installed"},{default:t(()=>[a(Qe,{ref_key:"pluginListRef",ref:v},null,512)]),_:1}),a(e(M),{name:"settting"},{title:t(()=>[a(e(se),null,{dropdown:t(()=>[a(e(ue),null,{default:t(()=>[a(e(ne),{onClick:Z},{default:t(()=>[a(e(F),{name:"plugin",class:"tiny-svg-size icon-fileupload"}),d(" \u4ECE\u672C\u5730\u78C1\u76D8\u5B89\u88C5... ")]),_:1})]),_:1})]),default:t(()=>[a(e(y),{class:"demp-tabs-icon"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),a(e(ee),{visible:I.value,"onUpdate:visible":_[1]||(_[1]=x=>I.value=x),title:"\u4E0A\u4F20\u63D2\u4EF6",fullscreen:"true"},{default:t(()=>[a(e(le),{action:o.value,headers:p,"before-upload":s,accept:".jar",name:"plugin","list-type":"saas",onSuccess:c,onError:m,onProgress:L},{trigger:t(()=>[a(e(w),{type:"primary"},{default:t(()=>[d("\u9009\u62E9\u6587\u4EF6")]),_:1})]),_:1},8,["action","headers"])]),_:1},8,["visible"])],64))}});var ct=N(et,[["__scopeId","data-v-060d63c2"]]);export{ct as default};
