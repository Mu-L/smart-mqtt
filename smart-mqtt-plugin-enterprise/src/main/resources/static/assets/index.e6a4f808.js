import{i as P,l as R,n as v,q as F,t as C,w as K,x as U,y as w,z as L,A as B,C as c,D as S,E as G}from"./index.044b2d75.js";const H=/%[sdj%]/g;let I=()=>{};function D(e){if(!e||!e.length)return null;const t={};return e.forEach(s=>{const i=s.field;t[i]=t[i]||[],t[i].push(s)}),t}function x(...e){let t=1;const s=e[0],i=e.length;return typeof s=="function"?s.apply(null,e.slice(1)):typeof s=="string"?String(s).replace(H,a=>{if(a==="%%")return"%";if(t>=i)return a;switch(a){case"%j":try{return JSON.stringify(e[t++])}catch{return"[Circular]"}case"%d":return Number(e[t++]);case"%s":return String(e[t++]);default:return a}}):s}function J(e){return["string","url","hex","email","pattern","digits","time","dateYMD","longDateTime","dateTime","dateYM","version","speczh","specialch","specialch2","acceptImg","acceptFile","fileSize"].includes(e)}function m(e,t){return!!(P(e)||t==="array"&&Array.isArray(e)&&!e.length||J(t)&&typeof e=="string"&&!e)}function W(e){return Object.keys(e).length===0}function Q(e,t,s){let i=0;const n=[],a=e.length;function r(d){n.push.apply(n,d),i++,i===a&&s(n)}e.forEach(d=>{t(d,r)})}function Y(e,t,s){let i=0;const n=e.length;function a(r){if(r&&r.length){s(r);return}const d=i;i=i+1,d<n?t(e[d],a):s([])}a([])}function X(e){const t=[];return Object.keys(e).forEach(s=>{t.push.apply(t,e[s])}),t}function N(e,t,s,i){if(t.first){const q=new Promise((g,u)=>{const y=u,M=E=>(i(E),E.length?y({errors:E,fields:D(E)}):g()),j=X(e);Y(j,s,M)});return q.catch(g=>g.errors&&g.fields||R.logger.error(g)),q}let n=t.firstFields||[];n===!0&&(n=Object.keys(e));let a=0;const r=Object.keys(e),d=r.length,o=[],f=new Promise((q,g)=>{const u=g,y=M=>{if(o.push.apply(o,M),a++,a===d)return i(o),o.length?u({errors:o,fields:D(o)}):q()};r.forEach(M=>{const j=e[M];n.includes(M)?Y(j,s,y):Q(j,s,y)})});return f.catch(q=>q.errors&&q.fields||R.logger.error(q)),f}function T(e){return t=>t&&t.message?(t.field=t.field||e.fullField,t):{message:typeof t=="function"?t():t,field:t.field||e.fullField}}function O(e,t){if(!t)return e;for(const s in t)if(v.call(t,s)){const i=t[s];typeof i=="object"&&typeof e[s]=="object"?e[s]=F(F({},e[s]),i):e[s]=i}return e}var V=Object.freeze(Object.defineProperty({__proto__:null,asyncMap:N,complementError:T,convertFieldsError:D,deepMerge:O,format:x,isEmptyObject:W,isEmptyValue:m,warning:I},Symbol.toStringTag,{value:"Module"}));function p(e,t){p.getSystemMessage=()=>p.getDefaultMessage(t),p.messages=p.getSystemMessage(t),p.systemMessages=p.messages,this.rules=null,this._messages=p.systemMessages,this.define(e)}const k=e=>t=>{let s,i=[],n={};function a(r){Array.isArray(r)?i=i.concat(...r):i.push(r)}for(s=0;s<t.length;s++)a(t[s]);i.length?n=D(i):(i=null,n=null),e(i,n)},ee=(e,t)=>{let s=(e.type==="object"||e.type==="array")&&(typeof e.fields=="object"||typeof e.defaultField=="object");return s=s&&(e.required||!e.required&&t.value),s},te=(e,t)=>{let s={};function i(n,a){return K(F({},a),{fullField:`${e.fullField}.${n}`})}if(e.defaultField)for(const n in t.value)v.call(t.value,n)&&(s[n]=e.defaultField);s=F(F({},s),t.rule.fields);for(const n in s)if(v.call(s,n)){const a=Array.isArray(s[n])?s[n]:[s[n]];s[n]=a.map(i.bind(null,n))}return s},ie=e=>(Array.isArray(e)||(e=[e]),e),ne=({rule:e,failds:t,options:s})=>(e.message?t=[].concat(e.message).map(T(e)):s.error?t=[s.error(e,x(s.messages.required,e.field))]:t=[],t),se=({data:e,options:t})=>{if(e.rule.options){let{messages:s,error:i}=t;Object.assign(e.rule.options,{messages:s,error:i})}},ae=({failds:e,doIt:t})=>s=>{const i=[];e&&e.length&&i.push(...e),s&&s.length&&i.push(...s),t(i.length?i:null)},re=(e,t,s,i,n)=>(a=[])=>{let r=a;const d=ee(t,n);if(r=ie(r),!e.suppressWarning&&r.length&&p.warning("async-validator:",r),r.length&&t.message&&(r=[].concat(t.message)),r=r.map(T(t)),e.first&&r.length)return s[t.field]=1,i(r);if(d){if(t.required&&!n.value)return r=ne({rule:t,failds:r,options:e}),i(r);const o=new p(te(t,n));o.messages(e.messages),se({data:n,options:e}),o.validate(n.value,n.rule.options||e,ae({failds:r,doIt:i}))}else i(r)};p.prototype={messages(e){return e&&(this._messages=O(p.getSystemMessage(),e)),this._messages},define(e){if(!e)throw new Error("Cannot configure a schema with no rules");if(Array.isArray(e)||typeof e!="object")throw new TypeError("Rules must be an object");this.rules={};let t;Object.keys(e).forEach(s=>{v.call(e,s)&&(t=e[s],this.rules[s]=Array.isArray(t)?t:[t])})},getSeries(e,t,s){let i,n;const a={};return(e.keys||Object.keys(this.rules)).forEach(d=>{i=this.rules[d],n=t[d],i.forEach(o=>{let f=o;typeof f.transform=="function"&&(t===s&&(t=F({},t)),t[d]=f.transform(n),n=t[d]),typeof f=="function"?f={validator:f}:f=F({},f),f.validator=this.getValidationMethod(f),f.field=d,f.fullField=f.fullField||d,f.type=this.getType(f),e.custom&&Object.assign(f,e.custom),f.validator&&(a[d]=a[d]||[],a[d].push({rule:f,value:n,source:t,field:d}))})}),a},mergeMessage(e){if(e.messages){let t=this.messages();t===p.systemMessages&&(t=p.getSystemMessage()),O(t,e.messages),e.messages=t}else e.messages=this.messages()},validate(e,t={},s=()=>{}){let i=e,n=t,a=s;if(typeof n=="function"&&(a=n,n={}),!this.rules||Object.keys(this.rules).length===0)return a&&a(),Promise.resolve();const r=k(a);this.mergeMessage(n);const d=this.getSeries(n,i,e),o={};return N(d,n,(f,q)=>{const g=f.rule,u=re(n,g,o,q,f);let y;g.asyncValidator?y=g.asyncValidator(g,f.value,u,f.source,n):g.validator&&(y=g.validator(g,f.value,u,f.source,n),y===!0?u():y===!1?u(g.message||`${g.field} fails`):Array.isArray(y)?u(y):y instanceof Error&&u(y.message)),y&&y.then&&y.then(()=>u(),M=>u(M))},f=>{r(f)})},getValidationMethod(e){if(C(e.validator))return e.validator;const t=Object.keys(e),s=t.indexOf("message");return s>-1&&t.splice(s,1),t.length===1&&t[0]==="required"?p.validators.required:p.validators[this.getType(e)]||!1},getType(e){if(e.type===void 0&&e.pattern instanceof RegExp&&(e.type="pattern"),typeof e.validator!="function"&&e.type&&!v.call(p.validators,e.type))throw new Error(x("Unknown rule type %s",e.type));return e.type||"string"}};p.register=(e,t)=>{if(typeof t!="function")throw new TypeError("Cannot register a validator by type, validator is not a function");p.validators[e]=t};p.validators={};p.warning=I;p.messages={};p.systemMessages={};p.getDefaultMessage=()=>{};var $=p;function Z({rule:e,checkValue:t,source:s,errors:i,options:n,type:a}){e.required&&(!v.call(s,e.field)||m(t,a||e.type))&&i.push(x(n.messages.required,e.fullField))}const fe='^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))',de=new RegExp(fe+"@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,6}))$"),b={acceptImg:/\.(png|jpe?g|gif)$/,acceptFile:/\.(doc?x|xls?x|ppt?x|txt)$/,email:de,fileSize:/^\d+(\.\d+)?[KMGTPEZY]?B$/i,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,speczh:/^[0-9a-zA-Z_\u4E00-\u9FA5]+$/,specialch:/^[0-9a-zA-Z_\-.]+$/,specialch2:/^[0-9a-zA-Z_-]+$/,url:/^([a-zA-Z]{3,}):\/\/([\w-]+\.)+[\w]+(\/[a-zA-Z- ./?%&=]*)?/i,version:/^\d+\.\d+(\.\d+)*$/},A={integer:e=>A.number(e)&&parseInt(e,10)===e,float:e=>A.number(e)&&!A.integer(e),array:Array.isArray,regexp(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:U,number:w,object:e=>L(e)&&!A.array(e),method:e=>B(e)==="function",email:e=>c(e)||!!e.match(b.email)&&e.length<255,url:e=>c(e)||!!e.match(b.url),hex:e=>c(e)||!!e.match(b.hex),digits:e=>c(e)||/^\d+$/.test(e),time:e=>c(e)||/^((0)[0-9]|1[0-9]|20|21|22|23):([0-5][0-9])$/.test(e),dateYM:e=>c(e)||S(e,"yyyy-MM")===e,dateYMD:e=>c(e)||S(e,"yyyy-MM-dd")===e,dateTime:e=>c(e)||S(e,"yyyy-MM-dd hh:mm")===e,longDateTime:e=>c(e)||S(e,"yyyy-MM-dd hh:mm:ss")===e,version:e=>c(e)||!!e.match(b.version),speczh:e=>c(e)||!!e.match(b.speczh),specialch:e=>c(e)||!!e.match(b.specialch),specialch2:e=>c(e)||!!e.match(b.specialch2),acceptImg:e=>c(e)||!!e.match(b.acceptImg),acceptFile:e=>c(e)||!!e.match(b.acceptFile),fileSize:e=>c(e)||!!e.match(b.fileSize)};function oe(e,t,s,i,n){if(e.required&&t===void 0){Z(e);return}const a=["array","acceptImg","acceptFile","date","digits","dateTime","dateYM","dateYMD","email","float","fileSize","hex","integer","longDateTime","method","number","object","regexp","speczh","specialch","specialch2","time","version","url"],r=e.type;a.includes(r)?A[r](t)||i.push(x(n.messages.types[r],e.fullField,e.type)):r&&typeof t!==e.type&&i.push(x(n.messages.types[r],e.fullField,e.type))}function le({min:e,max:t,val:s,key:i,rule:n,errors:a,util:r,options:d}){e&&!t&&s<n.min?a.push(r.format(d.messages[i].min,n.fullField,n.min)):t&&!e&&s>n.max?a.push(r.format(d.messages[i].max,n.fullField,n.max)):e&&t&&(s<n.min||s>n.max)&&a.push(r.format(d.messages[i].range,n.fullField,n.min,n.max))}function pe(e,t,s,i,n){const a=w(e.len),r=w(e.min),d=w(e.max);let o=t,f=null;const q=w(t),g=typeof t=="string",u=Array.isArray(t);if(q?f="number":g?f="string":u&&(f="array"),!f)return!1;u&&(o=t.length),g&&(o=G(t,"string")),a?o!==e.len&&i.push(x(n.messages[f].len,e.fullField,e.len)):le({min:r,max:d,val:o,key:f,rule:e,errors:i,util:V,options:n})}const _="enum";function ge(e,t,s,i,n){e[_]=Array.isArray(e[_])?e[_]:[],e[_].includes(t)||i.push(x(n.messages[_],e.fullField,e[_].join(", ")))}function me(e,t,s,i,n){e.pattern&&(e.pattern instanceof RegExp?(e.pattern.lastIndex=0,e.pattern.test(t)||i.push(x(n.messages.pattern.mismatch,e.fullField,t,e.pattern))):typeof e.pattern=="string"&&(new RegExp(e.pattern).test(t)||i.push(x(n.messages.pattern.mismatch,e.fullField,t,e.pattern))))}function ye(e,t,s,i,n){(/^\s+$/.test(t)||t==="")&&i.push(x(n.messages.whitespace,e.fullField))}var l={type:oe,range:pe,pattern:me,required:Z,whitespace:ye,enum:ge};function ce(e,t,s,i,n){const a=[],r=e.required||!e.required&&v.call(i,e.field),d=o=>o&&typeof o=="string"&&new Date(o).toString()!=="Invalid Date";if(r){if(m(t)&&!e.required)return s();if(l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),!m(t)){let o;typeof t=="number"||d(t)?o=new Date(t):o=t,l.type(e,o,i,a,n),o&&typeof o.getTime=="function"&&l.range(e,o.getTime(),i,a,n)}}s(a)}function h(e,t,s,i,n){const a=e.type,r=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t,a)&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:r,options:n,type:a}),m(t,a)||l.type(e,t,i,r,n)}s(r)}function he(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t)&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),t!==void 0&&(l.type(e,t,i,a,n),l.range(e,t,i,a,n))}s(a)}function ve(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t,"array")&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n,type:"array"}),m(t,"array")||(l.type(e,t,i,a,n),l.range(e,t,i,a,n))}s(a)}function ue(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t,"string")&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n,type:"string"}),m(t,"string")||(l.type(e,t,i,a,n),l.range(e,t,i,a,n),l.pattern(e,t,i,a,n),e.whitespace===!0&&l.whitespace(e,t,i,a,n))}s(a)}function z(e,t,s,i,n){const a=e.required||!e.required&&v.call(i,e.field),r=[];if(a){if(!e.required&&m(t))return s();l.required({rule:e,checkValue:t,source:i,errors:r,options:n}),t!==void 0&&l.type(e,t,i,r,n)}s(r)}function qe(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(t===""&&(t=void 0),!e.required&&m(t))return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),t!==void 0&&(l.type(e,t,i,a,n),l.range(e,t,i,a,n))}s(a)}function xe(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t)&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),t!==void 0&&(l.type(e,t,i,a,n),l.range(e,t,i,a,n))}s(a)}function be(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t,"string")&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),m(t,"string")||l.pattern(e,t,i,a,n)}s(a)}function Me(e,t,s,i,n){const a=[],r=Array.isArray(t)?"array":typeof t;l.required({rule:e,checkValue:t,source:i,errors:a,options:n,type:r}),s(a)}const Fe="enum";function _e(e,t,s,i,n){const a=[];if(e.required||!e.required&&v.call(i,e.field)){if(m(t)&&!e.required)return s();l.required({rule:e,checkValue:t,source:i,errors:a,options:n}),t!==void 0&&l[Fe](e,t,i,a,n)}s(a)}var we={date:ce,float:he,array:ve,string:ue,method:z,number:qe,integer:xe,pattern:be,required:Me,hex:h,url:h,time:h,email:h,digits:h,dateYM:h,speczh:h,dateYMD:h,version:h,fileSize:h,regexp:z,object:z,dateTime:h,specialch:h,boolean:z,acceptImg:h,specialch2:h,acceptFile:h,longDateTime:h,enum:_e};const Ae=e=>({string:e("validation.types.string"),method:e("validation.types.method"),array:e("validation.types.array"),object:e("validation.types.object"),number:e("validation.types.number"),date:e("validation.types.date"),boolean:e("validation.types.boolean"),integer:e("validation.types.integer"),float:e("validation.types.float"),regexp:e("validation.types.regexp"),email:e("validation.types.email"),url:e("validation.types.url"),hex:e("validation.types.hex"),digits:e("validation.types.digits"),time:e("validation.types.time"),dateYM:e("validation.types.dateYM"),dateYMD:e("validation.types.dateYMD"),dateTime:e("validation.types.dateTime"),longDateTime:e("validation.types.longDateTime"),version:e("validation.types.version"),speczh:e("validation.types.speczh"),specialch:e("validation.types.specialch"),specialch2:e("validation.types.hex"),acceptImg:e("validation.types.acceptImg"),acceptFile:e("validation.types.acceptFile"),fileSize:e("validation.types.fileSize")});var je=(e=t=>t)=>({default:e("validation.default"),required:e("validation.required"),enum:e("validation.enum"),whitespace:e("validation.whitespace"),date:{format:e("validation.date.format"),parse:e("validation.date.parse"),invalid:e("validation.date.invalid")},types:Ae(e),string:{len:e("validation.string.len"),min:e("validation.string.min"),max:e("validation.string.max"),range:e("validation.string.range")},number:{len:e("validation.number.len"),min:e("validation.number.min"),max:e("validation.number.max"),range:e("validation.number.range")},array:{len:e("validation.array.len"),min:e("validation.array.min"),max:e("validation.array.max"),range:e("validation.array.range")},pattern:{mismatch:e("validation.pattern.mismatch")}});$.validators=we;$.getDefaultMessage=je;var Se=$;export{Se as v};
