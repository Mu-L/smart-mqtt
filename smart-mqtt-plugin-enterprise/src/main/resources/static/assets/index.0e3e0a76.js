import{d as E,a4 as x,Z as m,a9 as I,f as O,l as T,q as D,b as r,s as C,E as _,Q as l,x as j,A as P,U as k,V as G}from"./vue.fad201d8.js";import{z as V,bm as $,ci as L,br as N,d as U,b as w,_ as M,cf as R,c4 as Q}from"./index.044b2d75.js";import{c as q,d as H,S as Z,C as J}from"./index.940cbb63.js";import{D as K}from"./index.da6b19dd.js";import{P as W,C as b,G as X}from"./index.8f1b0feb.js";import"./index.b6e8563b.js";import{G as Y}from"./index.e05be9ee.js";import"./event.68ff4fe6.js";import"./index.e6a4f808.js";import"./del.93e43054.js";import"./index.c22fe26d.js";import"./help-circle.ad52b976.js";import"./index.cf4871b3.js";import"./resize-event.d6a86905.js";import"./index.3f73bd0d.js";import"./right.b44f62d9.js";const ee=e=>{const{dimension:t,rows:o}=e;return{data:o.map(c=>c[t])}},te=e=>{const{tooltipFormatter:t}=e;return{trigger:"item",triggerOn:"mousemove",formatter(o){if(t)return t.apply(null,arguments);let s=[];const{treeAncestors:c,value:f}=o;let u=[];return c.forEach((i,h)=>{h&&u.push(i.name)}),s.push(`${q(u.join("."))}`),s.push(`${H(f)}`),s.join("")}}},ae=e=>{const{dimension:t,metrics:o,rows:s,seriesMap:c}=e,f=[];return s.forEach(u=>{const i=c[u[t]],h={position:"right",fontSize:12,color:"#191919"},y={color:Z[0]},S={color:"rgba(25 ,25 ,25 , 0.10)"},v=16,g={type:"tree",name:u[t],data:u[o],itemStyle:y,label:h,lineStyle:S,symbolSize:v};i&&Object.keys(i).forEach(d=>{V(g[d])?Object.assign(g[d],i[d]):g[d]=i[d]}),f.push(g)}),f},se=(e,t,o,s)=>{const{dimension:c=e[0],metrics:f=e[1],seriesMap:u={}}=o,{legendVisible:i,tooltipFormatter:h,tooltipVisible:y}=s,v=ae({dimension:c,metrics:f,rows:t,seriesMap:u}),g={dimension:c,rows:t},d=i&&t.length>1&&ee(g),n=y&&te({tooltipFormatter:h});return{series:v,legend:d,tooltip:n}};function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},z.apply(this,arguments)}$([L,N]);var B=U(z({},J,{name:w+"ChartTree",data:function(){return this.chartHandler=se,{}}})),ne="3.12.0";B.install=function(e){e.component(B.name,B)};B.version=ne;const A=e=>(k("data-v-52174531"),e=e(),G(),e),oe={class:"container-list"},ie={class:"contain"},re={key:0},le={key:1},ue={key:2},ce=A(()=>C("span",{class:"status-dot"},null,-1)),de={class:"status-text"},pe=A(()=>C("div",null,"\u5185\u5BB9\u533A\u57DF",-1)),me=E({__name:"index",setup(e){const t=x({loading:!1}),o=x({component:W,attrs:{currentPage:1,pageSize:10,pageSizes:[10,20],total:10,layout:"total, prev, pager, next, jumper, sizes"}});let s=m([]);const c=m(),{loading:f}=I(t);m([]);const u=m(!1),i=m(!1);async function h(n={pageNo:1,pageSize:10,status:""}){t.loading=!0;try{const{data:a}=await Q();return s.value=a,{result:a,page:{total:a.length}}}finally{t.loading=!1}}const y=x({api:({page:n})=>{const{currentPage:a,pageSize:F}=n;return h({pageNo:a,pageSize:F})}});m(!0);const S=({code:n})=>{switch(n){case"showTopology":i.value=!0;break}};m(!1);const v=m();function g(){d.value={columns:["name","value"],rows:[{name:"tree1",value:[{name:"MQTT \u96C6\u7FA4",value:"",children:s.value.filter(n=>n.nodeType==="core").map(n=>({name:n.status==="running"?n.nodeId:"\u79BB\u7EBF",value:n.status==="running"?"":n.nodeId,children:s.value.filter(a=>a.nodeType==="worker"&&a.coreNodeId===n.nodeId).map(a=>({name:a.status==="running"?a.nodeId:"\u79BB\u7EBF",value:a.status==="running"?"":a.nodeId}))}))}]}]},v.value.resize()}const d=m();return(n,a)=>{const F=O("Breadcrumb");return T(),D("div",oe,[r(F,{items:["menu.list","menu.list.searchTable"]},null,8,["items"]),C("div",ie,[r(l(X),{ref_key:"taskGrid",ref:c,"fetch-data":y,pager:o,loading:l(f),size:"medium","auto-resize":!0,onToolbarButtonClick:S},{toolbar:_(()=>[r(l(Y),{buttons:[{code:"showTopology",name:"\u96C6\u7FA4\u62D3\u6251"}]})]),default:_(()=>[r(l(b),{field:"nodeId",title:"\u8282\u70B9ID",align:"center"}),r(l(b),{field:"nodeType",title:"\u8282\u70B9\u7C7B\u578B",align:"center"},{default:_(({row:p})=>[p.nodeType==="core"?(T(),D("span",re,"\u6838\u5FC3\u8282\u70B9")):p.nodeType==="worker"?(T(),D("span",le,"\u5DE5\u4F5C\u8282\u70B9")):(T(),D("span",ue,"\u672A\u77E5\u8282\u70B9"))]),_:1}),r(l(b),{field:"clusterEndpoint",title:"\u5185\u90E8\u901A\u4FE1\u5730\u5740",align:"center"}),r(l(b),{field:"status",title:n.$t("searchTable.form.status"),align:"center"},{default:_(({row:p})=>[C("span",{class:j(["status",{"status-closed":p.status==="stopped","status-finished":p.status==="running"}])},[ce,C("span",de,P(p.status),1)],2)]),_:1},8,["title"]),r(l(b),{field:"version",title:"\u7248\u672C\u53F7",align:"center"}),r(l(b),{field:"runtime",title:"\u8FD0\u884C\u65F6\u957F",align:"center"})]),_:1},8,["fetch-data","pager","loading"]),r(l(R),{title:"\u6807\u9898",visible:u.value,"onUpdate:visible":a[0]||(a[0]=p=>u.value=p)},{default:_(()=>[pe]),_:1},8,["visible"])]),r(l(K),{visible:i.value,"onUpdate:visible":a[1]||(a[1]=p=>i.value=p),title:"\u96C6\u7FA4\u62D3\u6251",onOpened:g,width:"80%",height:"80%"},{default:_(()=>[r(l(B),{ref_key:"chartRef",ref:v,data:d.value,settings:{seriesMap:{tree1:{top:"10%",left:"18%",bottom:"22%",right:"20%",symbolSize:20,edgeShape:"polyline",edgeForkPosition:"63%",lineStyle:{width:5},label:{backgroundColor:"#fff",position:"left",verticalAlign:"middle",align:"right",fontSize:18},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}},emphasis:{focus:"descendant"},expandAndCollapse:!0,animationDuration:550,animationDurationUpdate:750}}}},null,8,["data"])]),_:1},8,["visible"])])}}});var Ee=M(me,[["__scopeId","data-v-52174531"]]);export{Ee as default};
