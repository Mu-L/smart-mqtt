import{d as D,c as h,a as c,b as i,f as _,g as y,B as w,t as $,z as n,C as B,h as P,r as x,D as C,o as I,n as T,_ as V,q as u,x as d,F,E,G as b,y as g,H as W}from"./index-542e6b62.js";import{c as M}from"./index-2b9f3e72.js";import{c as H}from"./index-92e62e94.js";import{c as L}from"./index-9025e34b.js";import{c as N}from"./index-afd2bb3f.js";import{a as U}from"./api-44ad8cd4.js";const A={key:0,class:"lay-progress-circle"},Q=["viewBox","width","height"],j=["d"],q=["d"],G={key:0,class:"layui-progress-text lay-progress-circle__text"},J={key:0,class:"layui-progress-text"},K={name:"LayProgress"},O=D({...K,props:{percent:null,theme:null,color:null,size:null,showText:{type:Boolean},text:null,circle:{type:Boolean,default:!1},circleSize:{default:150},circleWidth:{default:6}},setup(t){const o=t,p=h(()=>[o.color?"background-color: "+o.color:"",{width:o.percent+"%"}]),a=h(()=>{let e;switch(o.theme){case"red":e="#ff5722";break;case"orange":e="#ffb800";break;case"green":e="#009688";break;case"cyan":e="#2f4056";break;case"blue":e="#1e9fff";break;case"black":e="#393d49";break;case"gray":e="#fafafa";break;default:e="#5FB878";break}return e=o.color?o.color:e,e});h(()=>{let e;return typeof o.percent=="string"?e=parseInt(o.percent):e=o.percent,e/100*360});const k=h(()=>{let e;typeof o.percent=="string"?e=parseInt(o.percent):e=o.percent;let l=o.circleSize/2-o.circleWidth/2,s=Math.PI*2*l;return`${e/100*s}px ${s}px`}),m=h(()=>{let e=o.circleSize,l=o.circleWidth;return`M ${e/2} ${e/2} m 0, -${(e-l)/2} a ${(e-l)/2}, ${(e-l)/2} 0 1, 1 0, ${e-l} a ${(e-l)/2}, ${(e-l)/2} 0 1, 1 0, -${e-l}`});return(e,l)=>t.circle?(c(),i("div",A,[(c(),i("svg",{viewBox:`0 0 ${t.circleSize} ${t.circleSize}`,width:t.circleSize,height:t.circleSize},[_("path",{d:y(m),style:w([{fill:"none",stroke:"var(--global-neutral-color-3)"},{strokeWidth:`${t.circleWidth}px`}])},null,12,j),_("path",{d:y(m),style:w([{fill:"none","stroke-linecap":"round"},{strokeDasharray:y(k),stroke:y(a),strokeWidth:`${t.circleWidth}px`}])},null,12,q)],8,Q)),t.showText?(c(),i("div",G,$(t.text?t.text:t.percent+"%"),1)):n("",!0)])):(c(),i("div",{key:1,class:B(["layui-progress","layui-progress-"+t.size])},[_("div",{class:B(["layui-progress-bar","layui-bg-"+t.theme]),style:w(y(p))},[t.showText?(c(),i("span",J,$(t.text?t.text:t.percent+"%"),1)):n("",!0)],6)],2))}}),R=P(O);const X={setup(){const t=[{title:"名称",width:"200px",key:"name",customSlot:"name"},{title:"状态",width:"180px",key:"status",customSlot:"status"},{title:"运行时长",width:"120px",key:"runtime"},{title:"版本信息",width:"120px",key:"version"},{title:"进程",width:"120px",key:"pid"},{title:"操作系统内存",width:"180px",key:"memory",customSlot:"memory"},{title:"操作系统CPU负载",width:"180px",key:"cpu",customSlot:"cpu"}],o=x([{title:"基础配置",dynamic_config:[{label:"MaxPacketSize",prop:"MaxPacketSize",placeholder:"MQTT最大消息体字节数"},{label:"TopicLimit",prop:"TopicLimit",placeholder:"topic数量上限"}],restart_config:[{label:"Host",prop:"host",placeholder:"Broker服务IP地址"},{label:"Port",prop:"port",placeholder:"Broker服务端口号"}]},{title:"企业插件",dynamic_config:[{label:"Host",prop:"host",placeholder:"Broker服务IP地址"},{label:"Port",prop:"port",placeholder:"Broker服务端口号"}],restart_config:[{label:"Host",prop:"host",placeholder:"Broker服务IP地址"},{label:"Port",prop:"port",placeholder:"Broker服务端口号"}]}]),p=x([]),a=x(!1),k=x(0),m=C({host:"",port:"",bufferSize:"",maxPacketSize:"",topicLimit:"",maxInflight:""});let e;const l=s=>{a.value=!0};return I(()=>{const s=async()=>{const{data:f}=await U();console.log(f),p.value=f};s(),e=setInterval(()=>{s()},2e3)}),T(()=>{console.log("clear timer"),clearInterval(e)}),{columns2:t,dataSource2:p,modalVisible:a,brokerForm:m,currentTab:k,brokerConfig:o,editBroker:l}}},Y=["onClick"],Z={key:0},ee={key:1},te={key:2};function oe(t,o,p,a,k,m){const e=W,l=N,s=R,f=L,S=H,v=M,z=E;return c(),i(F,null,[u(S,null,{default:d(()=>[u(f,{columns:a.columns2,"data-source":a.dataSource2,size:"md",skin:"nob"},{name:d(({data:r})=>[_("a",{onClick:re=>a.editBroker(r),href:"javascript:void(0);"},[b($(r.name),1),u(e,{type:"layui-icon-edit",style:{position:"absolute",right:"10px"}})],8,Y)]),status:d(({data:r})=>[r.status=="running"?(c(),i("div",Z,[u(l,{type:"dot",theme:"blue",ripple:""}),b(" 运行中 ")])):n("",!0),r.status=="stopped"?(c(),i("div",ee,[u(l,{type:"dot"}),b(" 已离线 ")])):n("",!0),r.status=="unknown"?(c(),i("div",te,[u(l,{type:"dot"}),b(" 未知 ")])):n("",!0)]),memory:d(({data:r})=>[r.memory<30?(c(),g(s,{key:0,percent:r.memory,"show-text":!0,style:{width:"100px"}},null,8,["percent"])):n("",!0),r.memory>=30?(c(),g(s,{key:1,theme:"orange",percent:r.memory,"show-text":!0,style:{width:"100px"}},null,8,["percent"])):n("",!0)]),cpu:d(({data:r})=>[r.cpu<60?(c(),g(s,{key:0,percent:r.cpu,"show-text":!0,style:{width:"100px"}},null,8,["percent"])):n("",!0),r.cpu>=60?(c(),g(s,{key:1,theme:"orange",percent:r.cpu,"show-text":!0,style:{width:"100px"}},null,8,["percent"])):n("",!0)]),_:1},8,["columns","data-source"])]),_:1}),u(z,{type:"drawer",modelValue:a.modalVisible,"onUpdate:modelValue":o[0]||(o[0]=r=>a.modalVisible=r),title:"MQTT Broker配置"},{default:d(()=>[u(v,{status:"failure",describe:"开发中...",title:"提示"})]),_:1},8,["modelValue"])],64)}const ue=V(X,[["render",oe]]);export{ue as default};
